<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¿ƒåŠ¨ | ç²‰è‰²ä¸»é¢˜</title>
    <style>
        /* åŸºç¡€é‡ç½®ä¸å˜é‡å®šä¹‰ */
        :root {
            --primary-pink: #ff4081;
            --light-pink: #ff79b0;
            --pale-pink: #ffb6c1;
            --background-pink: #ffd6e7;
            --text-dark: #5a3a4d;
            --shadow-light: rgba(255, 64, 129, 0.15);
            --shadow-medium: rgba(255, 64, 129, 0.25);
            --shadow-strong: rgba(255, 64, 129, 0.4);
            --border-radius: 20px;
            --transition-speed: 0.3s;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(145deg, #ffd6e7 0%, #ffc2d1 100%);
            min-height: 100vh;
            overflow-x: hidden;
            color: var(--text-dark);
            line-height: 1.6;
            padding: 20px;
            position: relative;
        }

        /* åŠ è½½åŠ¨ç”» - 2026é£æ ¼ */
        #loading-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255, 214, 231, 0.95) 0%, rgba(255, 194, 209, 0.95) 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            transition: opacity 0.5s ease, visibility 0.5s ease;
            backdrop-filter: blur(10px);
        }

        .loading-spinner {
            width: 80px;
            height: 80px;
            position: relative;
            margin-bottom: 25px;
        }

        .loading-spinner::before,
        .loading-spinner::after {
            content: '';
            position: absolute;
            border-radius: 50%;
            border: 4px solid transparent;
            border-top-color: var(--primary-pink);
            animation: spin 1.5s cubic-bezier(0.68, -0.55, 0.27, 1.55) infinite;
        }

        .loading-spinner::before {
            width: 100%;
            height: 100%;
            border-width: 4px;
            opacity: 0.3;
        }

        .loading-spinner::after {
            width: 70%;
            height: 70%;
            top: 15%;
            left: 15%;
            border-width: 3px;
            animation-delay: 0.2s;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary-pink);
            text-shadow: 0 2px 10px var(--shadow-light);
            letter-spacing: 1px;
        }

        .loading-dots {
            display: inline-block;
            width: 20px;
            text-align: left;
        }

        .loading-dots::after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        /* ä¸»æ ‡é¢˜åŒºåŸŸ */
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            position: relative;
            z-index: 10;
        }

        .header h1 {
            font-size: clamp(2.5rem, 6vw, 4rem);
            background: linear-gradient(135deg, var(--primary-pink) 0%, var(--light-pink) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            font-weight: 800;
            letter-spacing: -0.5px;
        }

        .header p {
            font-size: clamp(1rem, 3vw, 1.3rem);
            color: var(--text-dark);
            max-width: 700px;
            margin: 0 auto 10px;
            opacity: 0.9;
        }

        .header .subtitle {
            font-size: 1rem;
            color: var(--primary-pink);
            font-weight: 500;
        }

        /* æŒ‰é’®å®¹å™¨ */
        .button-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 18px;
            max-width: 1000px;
            margin: 0 auto 50px;
            padding: 0 20px;
        }

        .action-button {
            background: linear-gradient(145deg, var(--primary-pink), var(--light-pink));
            color: white;
            border: none;
            padding: 18px 25px;
            border-radius: var(--border-radius);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 8px 25px var(--shadow-strong);
            transition: all var(--transition-speed) cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            min-height: 70px;
        }

        .action-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.7s ease;
        }

        .action-button:hover {
            transform: translateY(-6px) scale(1.02);
            box-shadow: 0 15px 35px var(--shadow-strong);
        }

        .action-button:hover::before {
            left: 100%;
        }

        .action-button:active {
            transform: translateY(-2px) scale(0.98);
        }

        /* å¼¹çª—ç³»ç»Ÿ - ä¼˜åŒ–ä½ç½® */
        #popup-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .popup {
            position: absolute;
            width: min(90vw, 380px);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.15), 0 5px 15px var(--shadow-medium);
            padding: 25px;
            z-index: 1001;
            animation: popupAppear 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            pointer-events: auto;
            border: 1px solid rgba(255, 182, 193, 0.3);
            transform-origin: center;
        }

        .popup::before {
            content: '';
            position: absolute;
            top: 8px;
            left: 8px;
            right: 8px;
            bottom: -8px;
            background: rgba(255, 182, 193, 0.2);
            border-radius: var(--border-radius);
            z-index: -1;
            filter: blur(12px);
            opacity: 0.6;
        }

        @keyframes popupAppear {
            0% {
                opacity: 0;
                transform: scale(0.8) translateY(30px);
            }
            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        .popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px dashed var(--pale-pink);
        }

        .popup-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-pink);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .close-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-pink), var(--light-pink));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.5rem;
            font-weight: 300;
            transition: all 0.2s ease;
            box-shadow: 0 4px 10px var(--shadow-medium);
            flex-shrink: 0;
        }

        .close-btn:hover {
            transform: rotate(90deg) scale(1.1);
            box-shadow: 0 6px 15px var(--shadow-strong);
        }

        .popup-content {
            color: var(--text-dark);
            line-height: 1.7;
            margin-bottom: 25px;
            max-height: 50vh;
            overflow-y: auto;
            padding-right: 10px;
            font-size: 1.05rem;
        }

        .popup-content::-webkit-scrollbar {
            width: 6px;
        }

        .popup-content::-webkit-scrollbar-track {
            background: rgba(255, 182, 193, 0.1);
            border-radius: 10px;
        }

        .popup-content::-webkit-scrollbar-thumb {
            background: var(--pale-pink);
            border-radius: 10px;
        }

        .popup-content::-webkit-scrollbar-thumb:hover {
            background: var(--light-pink);
        }

        .popup-footer {
            text-align: right;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 182, 193, 0.3);
        }

        .popup-btn {
            background: linear-gradient(135deg, var(--primary-pink), var(--light-pink));
            color: white;
            border: none;
            padding: 12px 28px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px var(--shadow-medium);
            min-width: 120px;
        }

        .popup-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px var(--shadow-strong);
        }

        .popup-btn:active {
            transform: translateY(0);
        }

        /* è®¾å¤‡æ£€æµ‹è­¦å‘Š */
        #device-warning {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.92);
            color: white;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 30px;
            z-index: 10001;
            backdrop-filter: blur(10px);
        }

        #device-warning h2 {
            color: var(--primary-pink);
            font-size: clamp(2rem, 5vw, 3rem);
            margin-bottom: 25px;
            font-weight: 700;
        }

        #device-warning p {
            font-size: clamp(1rem, 3vw, 1.2rem);
            max-width: 600px;
            margin-bottom: 20px;
            line-height: 1.7;
            opacity: 0.9;
        }

        #device-warning .emoji {
            font-size: 4rem;
            margin: 30px 0;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        /* å½©è›‹æŒ‰é’® */
        #easter-egg {
            position: fixed;
            bottom: 25px;
            right: 25px;
            width: 65px;
            height: 65px;
            background: linear-gradient(135deg, var(--primary-pink), var(--light-pink));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 28px;
            cursor: pointer;
            box-shadow: 0 8px 25px var(--shadow-strong);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            z-index: 100;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 8px 25px var(--shadow-strong); }
            50% { box-shadow: 0 8px 30px var(--shadow-strong), 0 0 0 10px rgba(255, 64, 129, 0.1); }
            100% { box-shadow: 0 8px 25px var(--shadow-strong); }
        }

        #easter-egg:hover {
            transform: scale(1.15) rotate(15deg);
            animation: none;
        }

        /* å¼¹çª—è®¡æ•° */
        .popup-count {
            position: fixed;
            top: 25px;
            right: 25px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            color: var(--primary-pink);
            padding: 12px 20px;
            border-radius: 50px;
            font-weight: 700;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            z-index: 100;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid rgba(255, 182, 193, 0.3);
        }

        .popup-count::before {
            content: 'ğŸ’Œ';
            font-size: 1.2rem;
        }

        /* é›ªèŠ±æ•ˆæœ */
        .snowflake {
            position: fixed;
            background-color: white;
            border-radius: 50%;
            pointer-events: none;
            opacity: 0.7;
            z-index: 1;
            filter: blur(1px);
            animation-timing-function: linear;
        }

        /* å“åº”å¼ä¼˜åŒ– */
        @media (max-width: 768px) {
            .button-container {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 0 10px;
            }
            
            .action-button {
                min-height: 60px;
                padding: 16px 20px;
                font-size: 1rem;
            }
            
            .popup {
                width: 90vw;
                padding: 20px;
            }
            
            .popup-count {
                top: 15px;
                right: 15px;
                padding: 10px 16px;
                font-size: 1rem;
            }
            
            #easter-egg {
                bottom: 20px;
                right: 20px;
                width: 55px;
                height: 55px;
                font-size: 24px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 15px;
            }
            
            .header {
                margin-bottom: 30px;
                padding: 10px;
            }
            
            .button-container {
                margin-bottom: 30px;
            }
            
            .popup-title {
                font-size: 1.3rem;
            }
        }

        /* ç‰¹æ®Šæ•ˆæœ */
        .heart-effect {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
            animation: heartFloat 2s ease-out forwards;
        }

        @keyframes heartFloat {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(0.5);
            }
        }
    </style>
</head>
<body>
    <!-- åŠ è½½åŠ¨ç”» -->
    <div id="loading-container">
        <div class="loading-spinner"></div>
        <div class="loading-text">åŠ è½½å¿ƒåŠ¨æ—¶åˆ»<span class="loading-dots"></span></div>
    </div>

    <!-- è®¾å¤‡æ£€æµ‹æç¤º -->
    <div id="device-warning">
        <div class="emoji">ğŸ“±</div>
        <h2>è®¾å¤‡å…¼å®¹æ€§æç¤º</h2>
        <p>æ£€æµ‹åˆ°æ‚¨çš„è®¾å¤‡å¯èƒ½æ— æ³•è·å¾—æœ€ä½³ä½“éªŒ</p>
        <p>å»ºè®®ä½¿ç”¨ iPhone 11 æˆ–åŒç­‰æ€§èƒ½çš„ Android è®¾å¤‡</p>
        <p>ä»¥è·å¾—å®Œæ•´çš„è§†è§‰æ•ˆæœå’Œäº¤äº’ä½“éªŒ</p>
        <p style="margin-top: 30px; color: var(--pale-pink); font-size: 0.9rem;">
            ğŸ’¡ æ¸©é¦¨æç¤ºï¼šçˆ±æ„ä¸å—è®¾å¤‡é™åˆ¶ï¼Œä½†çˆ±éœ€è¦åˆé€‚çš„è½½ä½“=äºº
        </p>
    </div>

    <!-- å½©è›‹æŒ‰é’® -->
    <div id="easter-egg" title="åŒå‡»å‘ç°éšè—æƒŠå–œ">âœ¨</div>

    <!-- å¼¹çª—è®¡æ•° -->
    <div class="popup-count">å¼¹çª—: <span id="popup-counter">0</span></div>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <div class="header">
        <h1>å¿ƒåŠ¨</h1>
        <p>æ¬¢è¿</p>
        <p>æˆ‘15ï¼Œå¹¶ä¸å¥½çœ‹çˆ±èƒ¡æ€ä¹±æƒ³çˆ±åƒé†‹èƒ¡æ€ä¹±æƒ³åˆåŠ ä¸Šäº†ç²¾ç¥æ´ç™–äºšå‹æ±¡æŸ“æ¶å¿ƒçš„èƒ¡æ€ä¹±æƒ³</p>
        <p class="subtitle">çˆ±ä½ </p>
    </div>

    <div class="button-container">
        <button class="action-button" id="btn-love">ğŸ˜˜ å‘Šç™½</button>
        <button class="action-button" id="btn-memory">ğŸ¥° å›å¿†</button>
        <button class="action-button" id="btn-promise">ğŸ¤— æ‰¿è¯º</button>
        <button class="action-button" id="btn-future">ğŸ˜Œ æœªæ¥</button>
        <button class="action-button" id="btn-surprise">ğŸ˜Š çˆ±ä½ </button>
        <button class="action-button" id="btn-secret">ğŸ” æƒ…ä¹¦</button>
    </div>

    <!-- å¼¹çª—å®¹å™¨ -->
    <div id="popup-container"></div>

    <script>
        // ==================== æ ¸å¿ƒé…ç½® ====================
        const CONFIG = {
            MAX_POPUPS: 8,
            INITIAL_POPUP_DELAY: 800,
            SNOWFLAKE_COUNT: 40,
            HEART_EFFECTS_ENABLED: true
        };

        // ==================== è®¾å¤‡æ£€æµ‹ ====================
        class DeviceDetector {
            constructor() {
                this.userAgent = navigator.userAgent;
                this.isCompatible = true;
            }

            checkCompatibility() {
                // æ¨¡æ‹Ÿè®¾å¤‡æ£€æµ‹é€»è¾‘ï¼ˆå®é™…é¡¹ç›®ä¸­åº”ä½¿ç”¨æ›´ç²¾ç¡®çš„æ£€æµ‹ï¼‰
                const isMobile = /iPhone|iPad|iPod|Android/i.test(this.userAgent);
                const performanceScore = this.calculatePerformanceScore();
                
                // æ¨¡æ‹Ÿæ—§è®¾å¤‡æ£€æµ‹ï¼ˆéšæœº30%æ¦‚ç‡ï¼‰
                const isOldDevice = Math.random() < 0.1;
                
                if (isMobile && (performanceScore < 0.6 || isOldDevice)) {
                    this.isCompatible = false;
                }
                
                return this.isCompatible;
            }

            calculatePerformanceScore() {
                // ç®€åŒ–çš„æ€§èƒ½è¯„åˆ†ï¼ˆå®é™…é¡¹ç›®åº”æ›´ç²¾ç¡®ï¼‰
                const memory = navigator.deviceMemory || 4;
                const cores = navigator.hardwareConcurrency || 4;
                const score = Math.min(1, (memory * cores) / 16);
                return score;
            }

            getDeviceInfo() {
                return {
                    userAgent: this.userAgent,
                    isMobile: /Mobi/i.test(this.userAgent),
                    isIOS: /iPad|iPhone|iPod/.test(this.userAgent),
                    isAndroid: /Android/i.test(this.userAgent),
                    compatibility: this.isCompatible
                };
            }
        }

        // ==================== å¼¹çª—ç®¡ç†ç³»ç»Ÿ ====================
        class PopupManager {
            constructor() {
                this.popups = new Map();
                this.counter = 0;
                this.zIndexBase = 1000;
                this.container = document.getElementById('popup-container');
                this.counterElement = document.getElementById('popup-counter');
                
                // è®°å½•å¼¹çª—ä½ç½®ï¼Œé¿å…é‡å 
                this.occupiedPositions = new Set();
            }

            // æ™ºèƒ½è®¡ç®—å¼¹çª—ä½ç½®
            calculateOptimalPosition() {
                const screenWidth = window.innerWidth;
                const screenHeight = window.innerHeight;
                const popupWidth = Math.min(380, screenWidth * 0.9);
                const popupHeight = 400; // ä¼°è®¡é«˜åº¦
                
                // å°è¯•å¤šä¸ªä½ç½®ï¼Œæ‰¾åˆ°æœ€ä½³ä½ç½®
                const positions = [
                    { left: screenWidth / 2 - popupWidth / 2, top: screenHeight / 2 - popupHeight / 2 }, // ä¸­å¿ƒ
                    { left: screenWidth * 0.3 - popupWidth / 2, top: screenHeight * 0.3 - popupHeight / 2 }, // å·¦ä¸Š
                    { left: screenWidth * 0.7 - popupWidth / 2, top: screenHeight * 0.3 - popupHeight / 2 }, // å³ä¸Š
                    { left: screenWidth * 0.3 - popupWidth / 2, top: screenHeight * 0.7 - popupHeight / 2 }, // å·¦ä¸‹
                    { left: screenWidth * 0.7 - popupWidth / 2, top: screenHeight * 0.7 - popupHeight / 2 }, // å³ä¸‹
                ];
                
                // è¿”å›ç¬¬ä¸€ä¸ªä¸åœ¨å±å¹•å¤–çš„ä½ç½®
                return positions.find(pos => 
                    pos.left > 20 && 
                    pos.left + popupWidth < screenWidth - 20 &&
                    pos.top > 80 && 
                    pos.top + popupHeight < screenHeight - 80
                ) || positions[0];
            }

            createPopup(title, content, buttonText = 'ç¡®è®¤') {
                if (this.counter >= CONFIG.MAX_POPUPS) {
                    this.closeOldestPopup();
                }

                this.counter++;
                this.updateCounter();
                
                // è®¡ç®—æœ€ä½³ä½ç½®
                const position = this.calculateOptimalPosition();
                
                const popupId = `popup-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
                const zIndex = this.zIndexBase + this.counter;
                
                const popupHTML = `
                    <div class="popup" id="${popupId}" 
                         style="left: ${position.left}px; top: ${position.top}px; z-index: ${zIndex}">
                        <div class="popup-header">
                            <div class="popup-title">${title}</div>
                            <div class="close-btn" onclick="popupManager.closePopup('${popupId}')">Ã—</div>
                        </div>
                        <div class="popup-content">${content}</div>
                        <div class="popup-footer">
                            <button class="popup-btn" onclick="popupManager.closePopup('${popupId}')">${buttonText}</button>
                        </div>
                    </div>
                `;
                
                this.container.insertAdjacentHTML('beforeend', popupHTML);
                
                const popupElement = document.getElementById(popupId);
                this.popups.set(popupId, {
                    element: popupElement,
                    createdAt: Date.now(),
                    zIndex
                });
                
                // æ·»åŠ ç‚¹å‡»ç½®é¡¶åŠŸèƒ½
                popupElement.addEventListener('mousedown', (e) => {
                    if (!e.target.closest('.close-btn') && !e.target.closest('.popup-btn')) {
                        this.bringToFront(popupId);
                    }
                });
                
                // æ·»åŠ è§¦æ‘¸æ”¯æŒ
                popupElement.addEventListener('touchstart', (e) => {
                    if (!e.target.closest('.close-btn') && !e.target.closest('.popup-btn')) {
                        this.bringToFront(popupId);
                    }
                });
                
                return popupId;
            }

            closePopup(popupId) {
                const popup = this.popups.get(popupId);
                if (!popup) return;
                
                popup.element.style.transform = 'scale(0.9) translateY(20px)';
                popup.element.style.opacity = '0';
                
                setTimeout(() => {
                    popup.element.remove();
                    this.popups.delete(popupId);
                    this.counter--;
                    this.updateCounter();
                }, 300);
            }

            closeOldestPopup() {
                if (this.popups.size === 0) return;
                
                const oldest = Array.from(this.popups.entries())
                    .reduce((oldest, current) => 
                        current[1].createdAt < oldest[1].createdAt ? current : oldest
                    );
                
                this.closePopup(oldest[0]);
            }

            bringToFront(popupId) {
                const popup = this.popups.get(popupId);
                if (!popup) return;
                
                this.zIndexBase++;
                const newZIndex = this.zIndexBase + this.counter;
                popup.element.style.zIndex = newZIndex;
                popup.zIndex = newZIndex;
            }

            updateCounter() {
                this.counterElement.textContent = this.counter;
            }

            closeAllPopups() {
                this.popups.forEach((_, popupId) => this.closePopup(popupId));
            }
        }

        // ==================== è§†è§‰æ•ˆæœç³»ç»Ÿ ====================
        class VisualEffects {
            static createSnowflakes() {
                for (let i = 0; i < CONFIG.SNOWFLAKE_COUNT; i++) {
                    setTimeout(() => this.createSnowflake(), i * 100);
                }
            }

            static createSnowflake() {
                const snowflake = document.createElement('div');
                snowflake.className = 'snowflake';
                
                const size = Math.random() * 8 + 4;
                const startX = Math.random() * 100;
                const duration = Math.random() * 15 + 10;
                
                snowflake.style.width = `${size}px`;
                snowflake.style.height = `${size}px`;
                snowflake.style.left = `${startX}vw`;
                snowflake.style.top = '-20px';
                snowflake.style.opacity = (Math.random() * 0.5 + 0.3).toString();
                
                // åˆ›å»ºåŠ¨ç”»
                const animation = snowflake.animate([
                    { transform: `translateY(0) rotate(0deg)` },
                    { transform: `translateY(120vh) rotate(${Math.random() * 720}deg)` }
                ], {
                    duration: duration * 1000,
                    easing: 'linear'
                });
                
                document.body.appendChild(snowflake);
                
                animation.onfinish = () => {
                    snowflake.remove();
                    this.createSnowflake();
                };
            }

            static createHeartEffect(x, y) {
                if (!CONFIG.HEART_EFFECTS_ENABLED) return;
                
                const hearts = ['ğŸ˜š', 'ğŸ’•', 'ğŸ’—', 'ğŸ’“', 'ğŸ’', 'ğŸ’˜'];
                const heart = document.createElement('div');
                heart.className = 'heart-effect';
                heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                heart.style.left = `${x}px`;
                heart.style.top = `${y}px`;
                heart.style.fontSize = `${Math.random() * 24 + 20}px`;
                
                document.body.appendChild(heart);
                
                setTimeout(() => heart.remove(), 2000);
            }

            static createConfetti() {
                for (let i = 0; i < 30; i++) {
                    setTimeout(() => {
                        const confetti = document.createElement('div');
                        confetti.style.cssText = `
                            position: fixed;
                            width: 10px;
                            height: 10px;
                            background: ${['#ff4081', '#ff79b0', '#ffb6c1', '#ffd6e7'][Math.floor(Math.random() * 4)]};
                            border-radius: 2px;
                            pointer-events: none;
                            z-index: 9999;
                            left: ${Math.random() * 100}vw;
                            top: -10px;
                        `;
                        
                        document.body.appendChild(confetti);
                        
                        confetti.animate([
                            { transform: 'translateY(0) rotate(0deg)', opacity: 1 },
                            { transform: `translateY(${window.innerHeight}px) rotate(${Math.random() * 360}deg)`, opacity: 0 }
                        ], {
                            duration: Math.random() * 2000 + 1500,
                            easing: 'cubic-bezier(0.215, 0.61, 0.355, 1)'
                        });
                        
                        setTimeout(() => confetti.remove(), 3500);
                    }, i * 50);
                }
            }
        }

        // ==================== å½©è›‹ç³»ç»Ÿ ====================
        class EasterEggSystem {
            constructor() {
                this.clickCount = 0;
                this.lastClickTime = 0;
                this.easterEggBtn = document.getElementById('easter-egg');
                this.setupListeners();
            }

            setupListeners() {
                this.easterEggBtn.addEventListener('click', (e) => {
                    const now = Date.now();
                    
                    // æ£€æµ‹åŒå‡»ï¼ˆ300mså†…ï¼‰
                    if (now - this.lastClickTime < 300) {
                        this.clickCount++;
                        
                        if (this.clickCount >= 2) { // åŒå‡»å³å¯è§¦å‘
                            this.triggerEasterEgg();
                            this.clickCount = 0;
                        }
                    } else {
                        this.clickCount = 1;
                    }
                    
                    this.lastClickTime = now;
                });
            }

            triggerEasterEgg() {
                const messages = [
                    "âœ¨ ä½ å‘ç°äº†éšè—çš„æ˜Ÿå…‰ï¼",
                    "ğŸ’« ä½ çš„ç»†å¿ƒè®©è¿™ä¸ªç©ºé—´æ›´åŠ é—ªè€€",
                    "ğŸŒŸ æ„¿è¿™ä»½æƒŠå–œå¦‚æ˜Ÿè¾°èˆ¬ç‚¹äº®ä½ çš„æ¯ä¸€å¤©",
                    "ğŸŒ  æ¯ä¸€ä¸ªéšè—çš„å½©è›‹éƒ½æ˜¯æˆ‘å¯¹ä½ çš„ç‰¹åˆ«å¿ƒæ„",
                    "ğŸ‡ æ­å–œä½ ï¼å‘ç°äº†è¿™ä¸ªç§˜å¯†è§’è½",
                    "ğŸ’– çœŸæ­£çš„é­”æ³•ï¼Œåœ¨äºå‘ç°ç¾å¥½çš„çœ¼ç›"
                ];
                
                const randomMessage = messages[Math.floor(Math.random() * messages.length)];
                
                popupManager.createPopup(
                    'ğŸŠ éšè—æƒŠå–œ ğŸŠ',
                    `<div style="text-align:center; padding:15px 0;">
                        <div style="font-size:4rem; margin:10px 0;">âœ¨</div>
                        <h3 style="color:var(--primary-pink); margin:15px 0;">${randomMessage}</h3>
                        <p style="margin-top:15px; color:var(--text-dark);">
                            ç»§ç»­æ¢ç´¢ï¼Œè¿™ä¸ªé¡µé¢è¿˜æœ‰æ›´å¤šå°ç§˜å¯†ç­‰å¾…å‘ç°ï¼
                        </p>
                    </div>`,
                    'å¤ªæ£’äº†ï¼'
     );
                
                // è§¦å‘ç‰¹æ®Šæ•ˆæœ
                VisualEffects.createConfetti();
                
                // èƒŒæ™¯é¢œè‰²å˜åŒ–æ•ˆæœ
                const originalBackground = document.body.style.background;
                const colors = [
                    'linear-gradient(145deg, #ffd6e7 0%, #ffc2d1 100%)',
                    'linear-gradient(145deg, #e7d6ff 0%, #d1c2ff 100%)',
                    'linear-gradient(145deg, #d6ffe7 0%, #c2ffd1 100%)',
                    'linear-gradient(145deg, #ffe7d6 0%, #ffd1c2 100%)'
                ];
                
                let i = 0;
                const interval = setInterval(() => {
                    document.body.style.background = colors[i % colors.length];
                    i++;
                }, 300);
                
                setTimeout(() => {
                    clearInterval(interval);
                    document.body.style.background = originalBackground;
                }, 1500);
            }
        }

        // ==================== æ•°æ®å†…å®¹ ====================
        const POPUP_CONTENTS = {
            love: {
                title: "ğŸ’– å°çº¸æ¡",
                content: `
                    <p>ä»é‡è§ä½ çš„é‚£ä¸€åˆ»èµ·ï¼Œæˆ‘çš„ä¸–ç•Œå¼€å§‹æœ‰äº†ä¸åŒçš„é¢œè‰²ã€‚</p>
                    <div style="background:rgba(255, 182, 193, 0.1); padding:15px; border-radius:10px; margin:15px 0;">
                        <p style="text-align:center; font-style:italic; color:var(--primary-pink);">
                            "ä¸æ˜¯å› ä¸ºæˆ‘éœ€è¦çˆ±æ‰çˆ±ä½ ï¼Œ<br>è€Œæ˜¯å› ä¸ºçˆ±ä½ ï¼Œæˆ‘æ‰æ‡‚å¾—äº†çˆ±çš„æ„ä¹‰"
                        </p>
                    </div>
                    <p>                    
                    ğŸ™‚ ä½ çˆ±æˆ‘æˆ‘çˆ±ä½ å¤©ç»åœ°ä¹‰ ,
                    ğŸ¤— å½“ç„¶ä½ æ°¸è¿œéƒ½æœ‰è‡ªç”±æˆ‘ä¸ä¼šé™åˆ¶ä½ å»ç¤¾äº¤å› ä¸ºè¿™æ˜¯ä½ çš„è‡ªç”±,
                    ğŸ˜• å¦‚æœä½ çœŸçš„ä¸å–œæ¬¢æˆ‘äº†ä½ å¯ä»¥å’Œæˆ‘åˆ†æ‰‹ä½†æ˜¯ä¸è¦ä»€ä¹ˆéƒ½ä¸è¯´å°±æ‹‰é»‘,
                    ğŸ™‚ è™½ç„¶ä½ è¯´äº†æˆ‘åƒé†‹äº†è®©æˆ‘ç»™ä½ è¯´ä½†æˆ‘è¿˜æ˜¯å®³æ€•ä½ ä¼šçƒ¦ã€‚</p>
                `
            },
            memory: {
                title: "ğŸ¥º ",
                content: `
                    <p>ğŸ¤¥ æœ‰æ—¶å€™æˆ‘ä¼šè¯´è°ï¼š</p>
                    <ul style="margin-left:20px; margin-top:10px;">
                        <li>æ¯”å¦‚æŸå¤©ç”Ÿæ°”"æˆ‘æ²¡äº‹""æˆ‘æ²¡ç”Ÿæ°”"å…¶å®éƒ½æ˜¯å‡çš„</li>
                        <li>å½“ç„¶ä½ ç»™æˆ‘å‘å¾ˆå¤šå¾ˆå¤šæ¶ˆæ¯æˆ‘ä¹Ÿä¸ä¼šå«Œä½ çƒ¦çœŸçš„</li>
                        <li>å½“ç„¶æˆ‘ä¸ä¼šå‡ºè½¨æˆ–è€…å’Œå…¶ä»–å¥³ç”Ÿæš§æ˜§æˆ–è€…è°ˆ</li>
                        <li>çˆ±ä½ æ¯ä¸€å¤©</li>
                    </ul>
                    <p style="margin-top:15px;">çˆ±ä½ ã€‚</p>
                `
            },
            promise: {
                title: "ğŸ¥º ",
                content: `
                    <p>æˆ‘æƒ³è¦ä½ ä¸€ç›´çˆ±æˆ‘ï¼š</p>
                    <div style="background:rgba(255, 182, 193, 0.1); padding:15px; border-radius:10px; margin:15px 0;">
                        <p>âœ…  æˆ‘ä¸€ç›´ä¸€ç›´çˆ±ä½ </p>
                        <p>âœ… åœ¨ä½ éœ€è¦æ—¶ï¼Œæˆ‘æ°¸è¿œéƒ½åœ¨</p>
                        <p>âœ…  æˆ‘ä¸ä¼šé™åˆ¶ä½ çš„è‡ªç”±</p>
                        <p>âœ… æ¯å¤©æ¯”æ˜¨å¤©æ›´çˆ±ä½ ä¸€ç‚¹</p>
                    </div>
                    <p>æ°¸è¿œéƒ½åœ¨çˆ±ä½ ã€‚</p>
                `
            },
            future: {
                title: "ğŸ™‚ åœ¨ä¸€èµ·",
                content: `
                    <p>æˆ‘æƒ³çš„æœªæ¥ï¼Œéƒ½æœ‰ä½ ï¼š</p>
                    <div style="display:grid; grid-template-columns:repeat(2, 1fr); gap:10px; margin:15px 0;">
                        <div style="background:rgba(255, 182, 193, 0.1); padding:10px; border-radius:8px; text-align:center;">
                            <div style="font-size:24px;">ğŸ™‚</div>
                            <div>æ°¸è¿œçˆ±ä½ ä½ æ°¸è¿œçˆ±æˆ‘</div>
                        </div>
                        <div style="background:rgba(255, 182, 193, 0.1); padding:10px; border-radius:8px; text-align:center;">
                            <div style="font-size:24px;">ğŸ™ƒ</div>
                            <div>æ°¸è¿œéƒ½åœ¨ä¸€èµ·</div>
                        </div>
                        <div style="background:rgba(255, 182, 193, 0.1); padding:10px; border-radius:8px; text-align:center;">
                            <div style="font-size:24px;">ğŸ™‚</div>
                            <div>æ°¸è¿œå¯¹ä½ å¥½/å¯¹æˆ‘å¥½</div>
                        </div>
                        <div style="background:rgba(255, 182, 193, 0.1); padding:10px; border-radius:8px; text-align:center;">
                            <div style="font-size:24px;">ğŸ˜•</div>
                            <div>çˆ±ä½ çš„å°å®å®</div>
                        </div>
                    </div>
                    <p>æœªæ¥å¾ˆé•¿ï¼Œä½†åªè¦æœ‰ä½ ï¼Œæ¯ä¸€æ­¥éƒ½å¼€å¿ƒã€‚</p>
                `
            },
            surprise: {
                title: "ğŸ‰ ç‰¹åˆ«æƒŠå–œ",
                content: `
                    <div style="text-align:center;">
                        <p>ä½ å‘ç°äº†ä¸€ä¸ªå°çº¸æ¡</p>
                        <div style="font-size:4rem; margin:15px 0;">ğŸ</div>
                        <h3 style="color:var(--primary-pink); margin:15px 0;">ç¥ä½ è¶Šæ¥è¶Šå¥½ï¼Œè¶Šæ¥è¶Šå¥½çœ‹ï¼Œèº«æå¥½ï¼Œæ‰‹ä¹Ÿå¾ˆå¥½çœ‹ï¼Œæœ‰é’±ï¼Œèº«ä½“å¥åº·ï¼Œæ°¸è¿œå¹¸ç¦ï¼Œæ°¸è¿œæ²¡æœ‰å™©æ¢¦</h3>
                        <p>ç‚¹å‡»ç¡®è®¤</p>
                    </div>
                `
            },
            secret: {
                title: "ğŸ” å°çº¸æ¡æƒ…ä¹¦",
                content: `
                    <p style="text-align:center; font-style:italic; margin:20px 0;">
                        å¦‚æœçˆ±æœ‰å£°éŸ³ï¼Œé‚£ä¸€å®šæ˜¯æˆ‘å¿ƒè·³çš„æ—‹å¾‹<br>
                        å¦‚æœçˆ±æœ‰é¢œè‰²ï¼Œé‚£ä¸€å®šæ˜¯ä½ çœ‹æˆ‘æ—¶çš„çœ¼ç›<br>
                        
                    </p>
                    <div style="background:rgba(255, 182, 193, 0.1); padding:15px; border-radius:10px; margin:15px 0; text-align:center;">
                        <p>è¿™å°æƒ…ä¹¦æ²¡æœ‰ç½²åï¼Œ</p>
                        <p>ä½†ä½ çŸ¥é“ï¼Œå®ƒåªä¸ºä½ è€Œå†™ã€‚</p>
                    </div>
                `
            }
        };

        // ==================== åˆå§‹åŒ– ====================
        let popupManager;
        let deviceDetector;
        let easterEggSystem;

        function init() {
            deviceDetector = new DeviceDetector();
            
            // è®¾å¤‡å…¼å®¹æ€§æ£€æŸ¥
            if (!deviceDetector.checkCompatibility()) {
                setTimeout(() => {
                    hideLoading();
                    document.getElementById('device-warning').style.display = 'flex';
                }, 1500);
                return;
            }
            
            // æ­£å¸¸åˆå§‹åŒ–æµç¨‹
            setTimeout(() => {
                hideLoading();
                
                // åˆå§‹åŒ–å¼¹çª—ç®¡ç†å™¨
                popupManager = new PopupManager();
                window.popupManager = popupManager;
                
                // åˆå§‹åŒ–è§†è§‰æ•ˆæœ
                VisualEffects.createSnowflakes();
                
                // åˆå§‹åŒ–å½©è›‹ç³»ç»Ÿ
                easterEggSystem = new EasterEggSystem();
                
                // ç»‘å®šæŒ‰é’®äº‹ä»¶
                bindButtonEvents();
                
                // åˆå§‹å¼¹çª—ï¼ˆå±…ä¸­æ˜¾ç¤ºï¼‰
                setTimeout(() => {
                    popupManager.createPopup(
                        POPUP_CONTENTS.love.title,
                        POPUP_CONTENTS.love.content,
                        'â¤ï¸ ç¡®è®¤'
                    );
                }, CONFIG.INITIAL_POPUP_DELAY);
                
                // çª—å£å¤§å°è°ƒæ•´æ—¶é‡æ–°è®¡ç®—å¼¹çª—ä½ç½®
                window.addEventListener('resize', handleResize);
                
                // æ·»åŠ éšæœºçˆ±å¿ƒæ•ˆæœ
                setInterval(() => {
                    if (Math.random() < 0.3 && CONFIG.HEART_EFFECTS_ENABLED) {
                        const x = Math.random() * window.innerWidth;
                        const y = Math.random() * window.innerHeight;
                        VisualEffects.createHeartEffect(x, y);
                    }
                }, 5000);
                
            }, 2000);
        }

        function bindButtonEvents() {
            document.getElementById('btn-love').addEventListener('click', () => {
                popupManager.createPopup(
                    POPUP_CONTENTS.love.title,
                    POPUP_CONTENTS.love.content,
                    'â¤ï¸ æˆ‘ä¹Ÿçˆ±ä½ '
                );
                createButtonEffect('btn-love');
            });
            
            document.getElementById('btn-memory').addEventListener('click', () => {
                popupManager.createPopup(
                    POPUP_CONTENTS.memory.title,
                    POPUP_CONTENTS.memory.content,
                    'çˆ±æˆ‘'
                );
                createButtonEffect('btn-memory');
            });
            
            document.getElementById('btn-promise').addEventListener('click', () => {
                popupManager.createPopup(
                    POPUP_CONTENTS.promise.title,
                    POPUP_CONTENTS.promise.content,
                    'æ‰¿è¯º'
                );
                createButtonEffect('btn-promise');
            });
            
            document.getElementById('btn-future').addEventListener('click', () => {
                popupManager.createPopup(
                    POPUP_CONTENTS.future.title,
                    POPUP_CONTENTS.future.content,
                    'æœŸå¾…'
                );
                createButtonEffect('btn-future');
            });
            
            document.getElementById('btn-surprise').addEventListener('click', () => {
                popupManager.createPopup(
                    POPUP_CONTENTS.surprise.title,
                    POPUP_CONTENTS.surprise.content,
                    'å°çº¸æ¡1'
                );
                createButtonEffect('btn-surprise');
                VisualEffects.createConfetti();
            });
            
            document.getElementById('btn-secret').addEventListener('click', () => {
                popupManager.createPopup(
                    POPUP_CONTENTS.secret.title,
                    POPUP_CONTENTS.secret.content,
                    'å°çº¸æ¡'
                );
                createButtonEffect('btn-secret');
            });
        }

        function createButtonEffect(buttonId) {
            const button = document.getElementById(buttonId);
            if (!button) return;
            
            button.style.transform = 'scale(0.95)';
            setTimeout(() => {
                button.style.transform = '';
            }, 150);
            
            // åˆ›å»ºçˆ±å¿ƒæ•ˆæœ
            const rect = button.getBoundingClientRect();
            const x = rect.left + rect.width / 2;
            const y = rect.top + rect.height / 2;
            
            VisualEffects.createHeartEffect(x, y);
        }

        function hideLoading() {
            const loadingContainer = document.getElementById('loading-container');
            loadingContainer.style.opacity = '0';
            loadingContainer.style.visibility = 'hidden';
            
            setTimeout(() => {
                loadingContainer.style.display = 'none';
            }, 500);
        }

        function handleResize() {
            // çª—å£å¤§å°æ”¹å˜æ—¶ï¼Œå¯ä»¥é‡æ–°è°ƒæ•´å¼¹çª—ä½ç½®
            // è¿™é‡Œå¯ä»¥æ·»åŠ æ›´å¤æ‚çš„å¼¹çª—ä½ç½®è°ƒæ•´é€»è¾‘
            console.log('çª—å£å¤§å°æ”¹å˜ï¼Œå¼¹çª—ä½ç½®å¯èƒ½éœ€è¦è°ƒæ•´');
        }

        // ==================== å¯åŠ¨åº”ç”¨ ====================
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>